<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cowork.admin.notice.mapper.AdminNoticeMapper">
	
	<!-- 공지사항 게시글 수 조회 -->
	<select id="getNoticeListCount">
		SELECT COUNT(*)
		FROM NOTICE
		WHERE NOTICE_DEL_FL = 'N'
	</select>
	
	<!-- 공지사항 조회 -->
	<select id="noticeList">
		SELECT
		     NOTICE_NO 
			,EMP_CODE
			,DEPT_NO
			,NOTICE_TITLE
			,DEPT_NM || ' ' || EMP_LAST_NAME || EMP_FIRST_NAME AS EMP_NAME
			,<![CDATA[
			 CASE 
				WHEN SYSDATE - NOTICE_WRITE_DATE < 1 / 24 / 60
				THEN FLOOR((SYSDATE - NOTICE_WRITE_DATE) * 24 * 60 * 60) || '초 전'
				WHEN SYSDATE - NOTICE_WRITE_DATE < 1 / 24
				THEN FLOOR((SYSDATE - NOTICE_WRITE_DATE) * 24 * 60) || '분 전'
				WHEN SYSDATE - NOTICE_WRITE_DATE < 1
				THEN FLOOR((SYSDATE - NOTICE_WRITE_DATE) * 24) || '시간 전'
				ELSE TO_CHAR(NOTICE_WRITE_DATE, '')
			 END NOTICE_WRITE_DATE
			 ]]>
		FROM NOTICE
		JOIN EMPLOYEE USING(EMP_CODE)
		JOIN TEAM USING(TEAM_NO)
		JOIN DEPARTMENT USING(DEPT_NO)
		WHERE NOTICE_DEL_FL = 'N'
		ORDER BY NOTICE_NO DESC
	</select>

</mapper>
